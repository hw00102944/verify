name: CI

on:
  pull_request:
    types: [opened, synchronize]
  push:
    branches:
    - master
    tags:
    - '*'

jobs:
  linux:
    runs-on: ubuntu-18.04
    strategy:
      matrix:
        pattern: [0, 1]
    steps:
      - name: Install g++-multilib
        run: |
          sudo apt-get update
          sudo apt-get install g++-multilib
      - name: build boost
        run: |
          BASE=`pwd`
          wget https://dl.bintray.com/boostorg/release/1.71.0/source/boost_1_71_0.tar.bz2
          tar xf boost_1_71_0.tar.bz2
          cd boost_1_71_0
          ./bootstrap.sh
          ./b2 -j4 --prefix=${BASE}/usr --libdir=${BASE}/usr/lib64 --with-chrono --with-context --with-filesystem --with-system --with-timer address-model=64 install
          ./b2 -j4 --prefix=${BASE}/usr --libdir=${BASE}/usr/lib32 --with-chrono --with-context --with-filesystem --with-system --with-timer address-model=32 install
